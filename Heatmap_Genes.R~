#############################################################################
# Heatmap for gene lists
#############################################################################

#Change workspace to directory where are the txt files with DAVID tables
setwd("/home/tiago/Copy/blast2GO_assembly_all")
#read input file in directory 
InFile <- as.matrix(read.table("heatmap_genes_GOinterest.csv", sep="\t", header=T))

#Build two heatmaps
## common to the two heatmaps
#plotCol <- c("forestgreen", "white", "red","steelblue")  # uncomment this two lines for non-gradient heatmap
#breaks <- c(-30, -0.58, 0.58, 30, 50)                    # uncomment this two lines for non-gradient heatmap
  
plotCol <- colorRampPalette( c("green", "black", "red"), space="rgb")(7)  #comment this line for non-gradient heatmap

#specific of the literature heatmap
heatTable <- apply(InFile[,3:9], c(1,2), as.numeric)
breaks <- c(seq(min(heatTable), -0.58, length=4), seq(0.58, max(heatTable), length=4))  #comment this line for non-gradient heatmap
pdf("heatmap_genes_GOinterest_literature_2_gradient.pdf")
par(oma=c(0,0,0,16))
heatmap(heatTable[1:27,], scale="n", breaks=breaks, col=plotCol, Rowv=NA, Colv=NA, cexCol=1, labRow=c(paste(InFile[,2], InFile[,10], sep="          ")), labCol=c("carol_fins", "carol_liver", "carol_muscle", "torg_fins", "torg_liver", "torg_muscle", "expected"), main="candidate DE genes")
heatmap(heatTable[1:27,], scale="n", breaks=breaks, col=plotCol, Rowv=NA, Colv=NA, cexCol=1, labRow=InFile[,1], labCol=c("carol_fins", "carol_liver", "carol_muscle", "torg_fins", "torg_liver", "torg_muscle", "expected"), main="candidate DE genes")
dev.off()

#specific for the heatmaps with the new genes from selected GOs
heatTable <- apply(InFile[,3:8], c(1,2), as.numeric)
breaks <- c(seq(min(heatTable), -0.58, length=4), seq(0.58, max(heatTable), length=4))  #comment this line for non-gradient heatmap
pdf("heatmap_genes_GOinterest_new_2_gradient.pdf")
par(oma=c(0,0,0,12))
heatmap(heatTable[28:60,], scale="n", breaks=breaks, col=plotCol, Rowv=NA, Colv=NA, cexCol=1, labRow=c(paste(InFile[28:60,2], InFile[28:60,10], sep="          ")), labCol=c("carol_fins", "carol_liver", "carol_muscle", "torg_fins", "torg_liver", "torg_muscle"), main="selected DE genes")
heatmap(heatTable[28:60,], scale="n", breaks=breaks, col=plotCol, Rowv=NA, Colv=NA, cexCol=1, labRow=InFile[28:60,1], labCol=c("carol_fins", "carol_liver", "carol_muscle", "torg_fins", "torg_liver", "torg_muscle"), main="selected DE genes")

dev.off()